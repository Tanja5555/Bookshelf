//>>built
define("epi-cms/content-approval/ApprovalService",["dojo/_base/declare","dojo/when","dojo/Deferred","dojo/Stateful","epi/shell/xhr/errorHandler","epi/dependency"],function(_1,_2,_3,_4,_5,_6){return _1([_4],{approvalStore:null,approvalDefinitionStore:null,postscript:function(){this.inherited(arguments);this.approvalStore=this.approvalStore||_6.resolve("epi.storeregistry").get("epi.cms.approval");this.approvalDefinitionStore=this.approvalDefinitionStore||_6.resolve("epi.storeregistry").get("epi.cms.approval.definition");},getApproval:function(_7){return _2(this.approvalStore.get(_7)).otherwise(function(){return null;});},approveChanges:function(_8){return _5.wrapXhr(this.approvalStore.executeMethod("ApproveChanges",_8.id,{activeStepIndex:_8.activeStepIndex}));},forceCompleteApproval:function(_9){var _a=this.approvalStore.executeMethod("ForceComplete",_9.id);return _5.wrapXhr(_a);},rejectChanges:function(_b){return _5.wrapXhr(this.approvalStore.executeMethod("RejectChanges",_b.id,{activeStepIndex:_b.activeStepIndex}));},cancelChanges:function(_c){return _5.wrapXhr(this.approvalStore.executeMethod("CancelChanges",_c.id));},getDefinition:function(_d){return _2(this.approvalDefinitionStore.get(_d)).otherwise(function(){return null;});},hasDefinition:function(_e){return this.getDefinition(_e).then(function(_f){return _f!==null&&_f.id!==0;});},saveDefinition:function(_10){if(!_10){return new _3().reject();}return _5.wrapXhr(this.approvalDefinitionStore.put(_10));},deleteDefinition:function(_11){return _5.wrapXhr(this.approvalDefinitionStore.remove(_11));},inheritDefinition:function(_12){return _5.wrapXhr(this.approvalDefinitionStore.executeMethod("Inherit",_12));}});});